Sub Roll()

Call RollValue(Range("A5").Value, "C6", "Accuracy Variance", "E5")
Call RollValue(Range("A7").Value, "F15", "Dodge Variance", "E7")
Call RollValue(Range("A8").Value, "E6", "Damage Variance", "E8")

Call RollValue(Range("A10").Value, "F17", "Durability Variance", "E10")
Call RollValue(Range("A11").Value, "F19", "Pain Tolerance Variance", "E11")
Call RollValue(Range("A12").Value, "F21", "Constitution Variance", "E12")

End Sub


Sub RollValue(charName As String, source As String, stat As String, destination As String)

If charName = "0" Then
    Range(destination).Value = "0"
    Exit Sub
End If

Dim sheetName As String
sheetName = Excel.WorksheetFunction.Lookup(charName, Range("$A$18:$A$27"), Range("$B$18:$B$27"))

Range(destination).Value = Rnd() * _
    Worksheets(sheetName).Range(source) _
    - Excel.WorksheetFunction.SumIfs(Range("W:W"), Range("S:S"), charName, Range("V:V"), stat)

End Sub
Sub ClearStats()

Range("D5:D12").Value = ""
Range("F5:F12").Value = ""


End Sub
Sub ClearHistory()

Range("M4:R200").Value = ""

End Sub

Sub AddWillPower(knobCell As String, benchMarkCell As String, RacerCell As String)

Dim knob As Range
Set knob = Range(knobCell)
Dim benchMark As Double
benchMark = Range(benchMarkCell).Value

While benchMark > Range(RacerCell).Value
    knob.Value = knob.Value + 1
Wend

End Sub

Sub WP_Accuracy()
Call AddWillPower("F5", "I7", "I5")
End Sub
Sub WP_Dodge()
Call AddWillPower("F7", "I5", "I7")
End Sub
Sub WP_Damage()
Call AddWillPower("F8", "I10", "I9")
End Sub
Sub WP_Durability()
Call AddWillPower("F10", "I9", "I10")
End Sub
Sub WP_PainTolerance()
Call AddWillPower("F11", "I9", "I11")
End Sub
Sub WP_Constitution()
Call AddWillPower("F12", "I9", "I12")
End Sub
